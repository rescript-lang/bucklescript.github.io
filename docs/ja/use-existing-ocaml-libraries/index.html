<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>既存のOCamlのライブラリの使用 · BuckleScript</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&gt; This section is reserved for advanced usages. Usually, you&#x27;d pick an OCaml/Reason library that&#x27;s already configured to work with our higher-level build system `bsb` (aka has a `bsconfig.json`). If not, you&#x27;d usually add a `bsconfig.json` to it. But if you want to directly use an OCaml package that&#x27;s not part of the npm workflow, or are building some quirky infra with BuckleScript, keep reading!"/><meta name="docsearch:language" content="ja"/><meta property="og:title" content="既存のOCamlのライブラリの使用 · BuckleScript"/><meta property="og:type" content="website"/><meta property="og:url" content="https://bucklescript.github.io/index.html"/><meta property="og:description" content="&gt; This section is reserved for advanced usages. Usually, you&#x27;d pick an OCaml/Reason library that&#x27;s already configured to work with our higher-level build system `bsb` (aka has a `bsconfig.json`). If not, you&#x27;d usually add a `bsconfig.json` to it. But if you want to directly use an OCaml package that&#x27;s not part of the npm workflow, or are building some quirky infra with BuckleScript, keep reading!"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/logos/bucklescript.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"/><link rel="alternate" type="application/atom+xml" href="https://bucklescript.github.io/blog/atom.xml" title="BuckleScript Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://bucklescript.github.io/blog/feed.xml" title="BuckleScript Blog RSS Feed"/><script type="text/javascript" src="/js/toggleSyntaxButton.js"></script><script type="text/javascript" src="/js/pjax-api.min.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/ja"><img class="logo" src="/img/logos/bucklescript.svg" alt="BuckleScript"/><h2 class="headerTitleWithLogo">BuckleScript</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/ja/installation" target="_self">資料</a></li><li class=""><a href="/docs/ja/playground" target="_self">試す</a></li><li class="siteNavGroupActive"><a href="/docs/ja/stdlib-overview" target="_self">API</a></li><li class=""><a href="/docs/ja/community" target="_self">コミュニティ</a></li><li class=""><a href="/blog/" target="_self">ブログ</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>日本語</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/use-existing-ocaml-libraries">English</a></li><li><a href="/docs/es-ES/use-existing-ocaml-libraries">Español</a></li><li><a href="/docs/fr/use-existing-ocaml-libraries">Français</a></li><li><a href="/docs/ko/use-existing-ocaml-libraries">한국어</a></li><li><a href="/docs/pt-BR/use-existing-ocaml-libraries">Português (Brasil)</a></li><li><a href="/docs/ru/use-existing-ocaml-libraries">Русский</a></li><li><a href="/docs/zh-CN/use-existing-ocaml-libraries">中文</a></li><li><a href="/docs/zh-TW/use-existing-ocaml-libraries">繁體中文</a></li><li><a href="https://crowdin.com/project/bucklescript" target="_blank" rel="noreferrer noopener">翻訳に参加する</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/bucklescript/bucklescript" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>上級者向け</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">はじめに</h3><ul><li class="navListItem"><a class="navItem" href="/docs/ja/what-why">はじめに</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/installation">インストール</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/new-project">プロジェクトの作成</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/concepts-overview">コンセプト</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">相互運用</h3><ul><li class="navListItem"><a class="navItem" href="/docs/ja/interop-overview">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/interop-cheatsheet">チートシート</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/embed-raw-javascript">生のJavaScriptの埋め込み</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/common-data-types">基本的なデータ型</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/intro-to-external">Externalの紹介</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/bind-to-global-values">グローバル変数の束縛</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/null-undefined-option">Null・UndefinedとOption</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/object">オブジェクト</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/object-2">オブジェクト その２</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/class">クラス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/function">関数</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/property-access">Property access</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/return-value-wrapping">Return value wrapping</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/import-export">ImportとExport</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/regular-expression">正規表現</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/exceptions">例外</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/json">JSON</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/pipe-first">Pipe First</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/generate-converters-accessors">変換と補助の生成</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/better-data-structures-printing-debug-mode">より良いデータ構造の出力 (デバッグモード)</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/nodejs-special-variables">NodeJSの特殊な変数</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/interop-misc">その他</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/browser-support-polyfills">ブラウザのサポートとポリフィル</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">ビルドシステム</h3><ul><li class="navListItem"><a class="navItem" href="/docs/ja/build-overview">概要</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/build-configuration">設定</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/automatic-interface-generation">インターフェースの自動生成</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/interop-with-js-build-systems">Interop with Other Build System</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/build-performance">パフォーマンス</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/build-advanced">上級者向け</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">標準ライブラリ</h3><ul><li class="navListItem"><a class="navItem" href="/docs/ja/stdlib-overview">概要</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">上級者向け</h3><ul><li class="navListItem"><a class="navItem" href="/docs/ja/conditional-compilation">条件付きコンパイル</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/extended-compiler-options">コンパイラ拡張の為のオプション</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/ja/use-existing-ocaml-libraries">既存のOCamlのライブラリの使用</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/difference-from-native-ocaml">ネイティブのOCamlとの違い</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/compiler-architecture-principles">コンパイラの設計と原則</a></li><li class="navListItem"><a class="navItem" href="/docs/ja/comparison-to-jsoo">Js_of_ocamlとの比較</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docMainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://crowdin.com/project/bucklescript/ja" target="_blank" rel="noreferrer noopener">Translate</a><h1 class="postHeaderTitle">既存のOCamlのライブラリの使用</h1></header><article><div><span><blockquote>
<p>This section is reserved for advanced usages. Usually, you'd pick an OCaml/Reason library that's already configured to work with our higher-level build system <code>bsb</code> (aka has a <code>bsconfig.json</code>). If not, you'd usually add a <code>bsconfig.json</code> to it. But if you want to directly use an OCaml package that's not part of the npm workflow, or are building some quirky infra with BuckleScript, keep reading!</p>
</blockquote>
<p>This guide is also a small walkthrough of how <code>bsb</code> works under the hood.</p>
<h2><a class="anchor" aria-hidden="true" id="built-in-npm-support"></a><a href="#built-in-npm-support" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Built in NPM support</h2>
<h3><a class="anchor" aria-hidden="true" id="build-an-ocaml-library-as-a-npm-package"></a><a href="#build-an-ocaml-library-as-a-npm-package" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Build an OCaml Library as a NPM Package</h3>
<p><strong>Note</strong>: this section might be slightly stale. If any of the steps aren't working, please file us an issue! Thanks.</p>
<p><strong>We highly recommend</strong> you try this endeavour on a dependency-less library first. It'd avoid lots of trouble.</p>
<p>BuckleScript's compiler, <code>bsc</code>, extends the OCaml compiler options with several flags to provide a better experience for NPM users.</p>
<p>In general, you are expected to see two kinds of build artifacts: the generated JS files and metadata that your OCaml dependencies rely on.</p>
<p>Since CommonJS has no namespaces, to allow JS files to live in different directories, we have a flag</p>
<pre><code class="hljs css language-sh">bsc.exe -bs-package-name <span class="hljs-variable">$npm_package_name</span> -bs-package-output modulesystem:path/to/your/js/dir -c a.ml
</code></pre>
<p>By passing this flag, <code>bsc.exe</code> will store your <code>package_name</code> and relative path to <code>package.json</code> in <code>.cmj</code> files. It will also generate JS files in the directory you specified. You can, and are encouraged to, store JavaScript files in a hierarchical directory.</p>
<p>For the binary artifacts (Note that this is not necessary if you only want your libraries to be consumed by JS developers, and it has benefit since end users don’t need these binary data any more), the convention is to store all <code>*.cm</code> data in a <em>single</em> directory <code>package.json/lib/ocaml</code> and Javascript files in a <em>hierachical</em> directory like <code>package.json/lib/js</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="use-an-ocaml-library-as-a-npm-package"></a><a href="#use-an-ocaml-library-as-a-npm-package" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Use an OCaml Library as a NPM Package</h3>
<p>If you follow the layout convention above, using an OCaml package is pretty straightforward:</p>
<pre><code class="hljs css language-sh">bsc.exe -I path/to/ocaml/package/installed -c a.ml
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="together"></a><a href="#together" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Together</h3>
<p>Your command line would be like this:</p>
<pre><code class="hljs css language-sh">bsc.exe -I path/to/ocaml/package1/installed -I path/to/ocaml/package2/installed  -bs-package-name <span class="hljs-variable">$npm_package_name</span> -bs-package-output commonjs:path/to/lib/js/ -c a.ml
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="examples"></a><a href="#examples" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Examples</h3>
<p>You can see a more elaborate <code>bsc</code> setup like so:</p>
<pre><code class="hljs css language-sh">bsb -init dummy-project
<span class="hljs-built_in">cd</span> dummy-project
npm run build
cat lib/bs/build.ninja
</code></pre>
<p>The <a href="https://ninja-build.org">Ninja</a> file, generated by <code>bsb</code>, describes the exact steps needed to build a trivial project using <code>bsc</code>.</p>
<p>Additionally, please consult <a href="https://github.com/chenglou/intro-to-reason-compilation">https://github.com/chenglou/intro-to-reason-compilation</a>, which covers the lowest-level <a href="https://reasonml.github.io">Reason</a> + BuckleScript compilation mechanisms.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/ja/extended-compiler-options"><span class="arrow-prev">← </span><span>前へ</span></a><a class="docs-next button" href="/docs/ja/difference-from-native-ocaml"><span>次へ</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav docOnPageNav"><ul class="toc-headings"><li><a href="#built-in-npm-support">Built in NPM support</a><ul class="toc-headings"><li><a href="#build-an-ocaml-library-as-a-npm-package">Build an OCaml Library as a NPM Package</a></li><li><a href="#use-an-ocaml-library-as-a-npm-package">Use an OCaml Library as a NPM Package</a></li><li><a href="#together">Together</a></li><li><a href="#examples">Examples</a></li></ul></li></ul></nav></div><span><script src="/js/redirectBlog.js"></script><script>window.foo = new Pjax({
          areas: [
            // try to use the first query.
            '.mainContainer, .docsNavContainer .toc .navWrapper, .onPageNav',
            // fallback
            'body'
          ],
          link: '.docsNavContainer:not(.docsSliderActive) a',
          update: {
            script: false,
          }
        });
        var languagesMenuItemCopy = document.getElementById("languages-menu");
        languagesMenuItemCopy.addEventListener("click", function(e){
          e.preventDefault();
          e.stopPropagation();
          e.stopImmediatePropagation();
        });</script></span></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                
                apiKey: '0fd97db83891aa20810559812d9e69ac',
                indexName: 'bucklescript',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["lang:ja"]}
              });
            </script></body></html>