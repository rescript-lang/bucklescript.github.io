<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>dev-mode-how-to · BuckleScript</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="dev-mode-how-to · BuckleScript"/><meta property="og:type" content="website"/><meta property="og:url" content="https://bucklescript.github.io/index.html"/><meta property="og:description" content="\#\# Contributions"/><link rel="shortcut icon" href="/img/logos/bucklescript_small.svg"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css"/><link rel="alternate" type="application/atom+xml" href="https://bucklescript.github.io/blog/atom.xml" title="BuckleScript Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://bucklescript.github.io/blog/feed.xml" title="BuckleScript Blog RSS Feed"/><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logos/bucklescript_small.svg"/><h2 class="headerTitle">BuckleScript</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/docs/zh-CN/installation.html" target="_self">文档</a></li><li><a href="/docs/zh-CN/playground.html" target="_self">Try</a></li><li><a href="/docs/zh-CN/community.html" target="_self">社区</a></li><li><a href="/blog" target="_self">博客</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg"/>中文</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/en">English</a></li><li><a href="/es-ES">Español</a></li><li><a href="/fr">Français</a></li><li><a href="https://crowdin.com/project/bucklescript" target="_blank">Help Translate</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(){
          if(languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li><li><a href="https://github.com/bucklescript/bucklescript" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://crowdin.com/project/bucklescript/zh-CN" target="_blank">Translate</a><h1>dev-mode-how-to</h1></header><article><div><span><p>## Contributions</p>
<p>First, thanks for your interest in contributing! There are plenty of ways to make contributions, like blogging, sharing your experience, open sourcing your libraries using BuckleScript. They are all deeply appreciated.</p>
<p>This section will focus on how to contribute to this repo.</p>
<p># Development set-up</p>
<ul>
<li><p>Having <a href="https://opam.ocaml.org/">opam</a> installed</p>
<pre><code class="hljs">  opam switch 4.02.3+buckle-master # use our OCaml compiler
  opam install camlp4  
</code></pre>
<p><code>Camlp4</code> is used to generate OCaml code for processing large AST. (<code>j.ml</code> file), if you don’t change <code>j.ml</code> (most likely you won’t), so you probably don’t need it</p></li>
<li><p>Having <a href="https://nodejs.org/">NodeJS</a> installed</p></li>
<li><p>Having Make installed</p></li>
<li><p>OS: Mac/Linux (Note BuckleScript works on Windows, but the dev mode is not tested)</p></li>
</ul>
<p><strong>Below assume that you are working in <code>jscomp</code> directory, and that you’ve followed instructions from [???](#Minimal dependencies) to build OCaml.</strong></p>
<p># Contributing to <code>bsb.exe</code></p>
<p>The build target is</p>
<pre><code class="hljs">make -C bin bsb.exe
</code></pre>
<p>So whenever you change files relevant to the build tool <code>bsb.exe</code>, try it and do some test. If it works, send a pull request!</p>
<p>Note that for most binaries in BuckleScript, we also have a <strong>release mode</strong>, which will pack all relevant files into a single file. This is important, since it will cut all our dev-dependencies, so the user does not need install those tools.</p>
<p>You can verify it by typing</p>
<pre><code class="hljs">make snapshotml # see the diffs in jscomp/bin
</code></pre>
<p>But please <strong>don’t commit</strong> those changes in PR, it will cause painful merge conflicts.</p>
<p># Contributing to <code>bsc.exe</code></p>
<pre><code class="hljs">make -C bin bsc.exe # build the compiler in dev mode

make libs # build all libs using the dev compiler
</code></pre>
<p>There is also a snapshot mode,</p>
<pre><code class="hljs">make snapshotml
</code></pre>
<p>This will actually snapshot your changes into a single ml file and used in npm distribution. But please <strong>don’t commit</strong> those changes in PR, it will cause painful merge conflicts.</p>
<p># Contributing to the runtime</p>
<p>BuckleScript runtime implementation is currently a mix of OCaml and JavaScript. (<code>jscomp/runtime</code> directory). The JavaScript code is defined in the <code>.ml</code> file using the <code>bs.raw</code> syntax extension.</p>
<p>The goal is to implement the runtime <strong>purely in OCaml</strong> and you can help contribute.</p>
<p>Each new PR should include appropriate testing.</p>
<p>Currently all tests are in <code>jscomp/test</code> directory and you should either add a new test file or modify an existing test which covers the part of the compiler you modified.</p>
<ul>
<li><p>Add the filename in <code>jscomp/test/test.mllib</code></p></li>
<li><p>Add a suite test</p></li>
</ul>
<p>The specification is in <code>jscomp/test/mt.ml</code></p>
<p>For example some simple tests would be like:</p>
<pre><code class="hljs">let suites : _ Mt.pair_suites =
   [&quot;hey&quot;, (fun _ -&gt; Eq(true, 3 &gt; 2));
       &quot;hi&quot;, (fun _ -&gt; Neq(2,3));
       &quot;hello&quot;, (fun _ -&gt; Approx(3.0, 3.0));
       &quot;throw&quot;, (fun _ -&gt; ThrowAny(fun _ -&gt; raise 3))
       ]
let () = Mt.from_pair_suites __FILE__ suites
</code></pre>
<ul>
<li>Run the tests</li>
</ul>
<p>Suppose you have mocha installed, if not, try <code>npm install mocha</code></p>
<p><code>mocha -R list jscomp/test/your_test_file.js</code></p>
<p>To build libs, tests and run all tests:</p>
<p><code>make libs &amp;&amp; make -C test all &amp;&amp; npm test</code></p>
<ul>
<li>See the coverage</li>
</ul>
<p><code>npm run cover</code></p>
<p># Contributing to the documentation</p>
<p>You’ll need <a href="http://asciidoctor.org/">Asciidoctor</a> installed and on your <code>PATH</code>. Go into <code>site/docsource/</code>, modify the section you want, and run <code>build.sh</code>. You can check the <code>build.compile</code> file for debug output.</p>
<p># Contributing to the API reference</p>
<p>The API reference is generated from doc comments in the source code. <a href="https://github.com/bucklescript/bucklescript/blob/99650/jscomp/others/js_re.mli#L146-L161">Here</a>'s a good example</p>
<p>Some tips and guidelines:</p>
<ul>
<li><p>The first sentence or line should be a very short summary. This is used in indexes and by tools like merlin.</p></li>
<li><p>Ideally, every function should have <strong>at least one</strong> <code>@example</code></p></li>
<li><p>Cross-reference another definition with <code>{! identifier}</code>. But use them sparingly, they’re a bit verbose (currently, at least).</p></li>
<li><p>Wrap non-cross-referenced identifiers and other code in <code>[ ... ]</code></p></li>
<li><p>Escape <code>{</code>, <code>}</code>, <code>[</code>, <code>]</code> and <code>@</code> using ``</p></li>
<li><p>It’s possible to use <code>{%html ...}</code> to generate custom html, but use this very, very sparingly.</p></li>
<li><p>A number of &quot;documentation tags&quot; are provided that would be nice to use, but unfortunately they’re often not supported for <code>external</code>s. Which is of course most of the API.</p></li>
<li><p><code>@param</code> usually doesn’t work. Use <code>{b &lt;param&gt;} ...</code> instead</p></li>
<li><p><code>@returns</code> usually doesn’t work. Use <code>{b returns} ...</code> instead.</p></li>
<li><p>Always use <code>@deprecated</code> when applicable.</p></li>
<li><p>Always use <code>@raise</code> when applicable.</p></li>
<li><p>Always provide a <code>@see</code> tag pointing to MDN for more information when available.</p></li>
</ul>
<p>See <a href="http://caml.inria.fr/pub/docs/manual-ocaml/ocamldoc.html#sec333">Ocamldoc documentation</a> for a lot more details.</p>
<p>To generate the html, run <code>make docs</code> in <code>jscomp/</code>.</p>
<p>Html generation uses a custom generator located in <code>odoc_gen/</code> and custom styles located in <code>docs/api_static</code>.</p>
</span></div></article></div><div class="docs-prevnext"></div></div></div></div><span><script src="/js/redirectBlog.js"></script><script src="/js/pjax-api.js"></script><script>window.foo = new Pjax({
          areas: [
            // try to use the first query.
            '.mainContainer, .docsNavContainer .toc .navWrapper',
            // fallback
            'body'
          ],
          link: '.docsNavContainer:not(.docsSliderActive) a',
          update: {
            script: false,
          }
        });
        var languagesMenuItemCopy = document.getElementById("languages-menu");
        languagesMenuItemCopy.addEventListener("click", function(e){
          e.preventDefault();
          e.stopPropagation();
          e.stopImmediatePropagation();
        });</script></span></div><script type="text/javascript" src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                apiKey: '0fd97db83891aa20810559812d9e69ac',
                indexName: 'bucklescript',
                inputSelector: '#search_input_react'
              });
            </script></body></html>